SELECT MAX(CONT) AS CONT, FECHA ,ID_SUCURSAL FROM (SELECT SUM(PRECIO_TOTAL) AS CONT, FECHA, ID_SUCURSAL FROM COMPRA WHERE ID IN (SELECT ID_COMPRA FROM PRODUCTO_COMPRA WHERE ID_PRODUCTO IN (SELECT ID FROM PRODUCTOS WHERE CATEGORIA = ?))GROUP BY ID_SUCURSAL, FECHA) GROUP BY FECHA, ID_SUCURSAL;

SELECT MIN(CONT) AS CONT, FECHA ,ID_SUCURSAL FROM (SELECT SUM(PRECIO_TOTAL) AS CONT, FECHA, ID_SUCURSAL FROM COMPRA WHERE ID IN (SELECT ID_COMPRA FROM PRODUCTO_COMPRA WHERE ID_PRODUCTO IN (SELECT ID FROM PRODUCTOS WHERE CATEGORIA = ?))GROUP BY ID_SUCURSAL, FECHA) GROUP BY FECHA, ID_SUCURSAL;

SELECT MAX(CUNT) AS CONT, FECHA, ID_SUCURSAL FROM (SELECT SUM(PRODUCTO_COMPRA.CANTIDAD) AS CUNT, COMPRA.ID_SUCURSAL AS ID_SUCURSAL, COMPRA.FECHA AS FECHA FROM PRODUCTO_COMPRA, COMPRA WHERE ID_PRODUCTO IN(SELECT ID FROM PRODUCTOS  WHERE CATEGORIA = ?) AND PRODUCTO_COMPRA.ID_COMPRA = COMPRA.ID GROUP BY COMPRA.ID_SUCURSAL, COMPRA.FECHA) GROUP BY FECHA, ID_SUCURSAL;

SELECT MIN(CUNT) AS CONT, FECHA, ID_SUCURSAL FROM (SELECT SUM(PRODUCTO_COMPRA.CANTIDAD) AS CUNT, COMPRA.ID_SUCURSAL AS ID_SUCURSAL, COMPRA.FECHA AS FECHA FROM PRODUCTO_COMPRA, COMPRA WHERE ID_PRODUCTO IN(SELECT ID FROM PRODUCTOS  WHERE CATEGORIA = ?) AND PRODUCTO_COMPRA.ID_COMPRA = COMPRA.ID GROUP BY COMPRA.ID_SUCURSAL, COMPRA.FECHA) GROUP BY FECHA, ID_SUCURSAL;